# Geometries and Aesthetics

-   [Available geometries](https://ggplot2.tidyverse.org/reference/index.html#section-layers)

-   Two steps:

    -   Step 1: What geometries do you see?

    -   Step 2: With a given geometry, what aesthetics do you observe?

------------------------------------------------------------------------

```{r , eval=T, echo=F}
teachDS::img_centering("https://i0.wp.com/cmdlinetips.com/wp-content/uploads/2019/11/scatter_plot_with_ggplot_scale_xy_log10_color.png")
```

-   Geometries?

-   Aesthetics?

------------------------------------------------------------------------

```{r , eval=T, echo=F}
teachDS::img_centering("https://belayeth.com/wp-content/uploads/2021/06/Rplot.png")
```

------------------------------------------------------------------------

```{r , eval=T, echo=F}
teachDS::img_centering("https://www.r-graph-gallery.com/img/graph/50-51-52-scatter-plot-with-ggplot2.png")
```

------------------------------------------------------------------------

```{r , eval=T, echo=F}
teachDS::img_centering("https://www.economist.com/img/b/1280/755/90/sites/default/files/images/2021/09/articles/main/20210918_woc289.png")
```

## An Example

```{r , eval=T, echo=F}
teachDS::img_centering("https://www.economist.com/img/b/600/895/90/sites/default/files/images/2021/09/articles/body/20210918_woc287.png")
```

-   Geom:\
    [`geom_point`](https://ggplot2.tidyverse.org/reference/geom_point.html):

    -   x, y：varies with observations

    -   color (線框顏色): constant

    -   stroke (線框粗細): constant

    -   fill (內部塗色): constant

    -   size (點的大小): constant

    [`geom_text`](https://ggplot2.tidyverse.org/reference/geom_text.html#aesthetics):

    -   x, y: varies with observations

    -   label: varies with observations

    -   hjust (文字水平錨點）：between 0 and 1

    -   vjust (文字垂直錨點）: between 0 and 1

```{r}
# take Colombia, Normway, and Gemany as an example
data4plot <- list()
data4plot$point$data <- {
  data.frame(
    x=c(52.5, 56, 58.5),
    y=c(48.6, 54.9, 58)
  )
}
data4plot$text$data <- {
  data.frame(
    x=c(52.5, 56, 58.5),
    y=c(48.6, 54.9, 58),
    label=c("Colombia", "Norway", "Germany")
  )
}
```

```{r}
myplot <- {
  ggplot()+
    geom_point(
      data=data4plot$point$data,
      mapping=aes(
        x=x, y=y
      ),
      fill="blue", 
      shape=21,  
      color="black",
      stroke=1,
      size=1 
    )+
    geom_text(
      data=data4plot$text$data,
      mapping=aes(
        x=x, y=y, label=label
      ),
      hjust = 1, 
      size = 1 
    )
}
myplot

```


  * use `econDV2::ggdash()` to quickly create a shiny app of your ggplot to fine tune your graph.

### econDV2::ggdash

```{r}
myplot <- {
  ggplot()+
    geom_point(
      data=data4plot$point$data,
      mapping=aes(
        x=x, y=y
      ),
      fill="blue", #input$fill_point
      shape=21, # default point is a circle without border, you need another type of point
      color="black", #input$color_point
      stroke=1, #input$stroke_point
      size=1 #input$size_point
    )+
    geom_text(
      data=data4plot$text$data,
      mapping=aes(
        x=x, y=y, label=label
      ),
      hjust = 1, #input$hjust_text
      size = 1 #input$size_text
    )
}
myplot

```



```{r}
myplot <- {
  ggplot() +
    geom_point(
      data = data4plot$point$data,
      mapping = aes(
        x = x, y = y
      ),
      fill = "#2fc1d3",
      shape = 21,
      color = "black",
      stroke = 1,
      size = 12
    ) +
    geom_text(
      data = data4plot$text$data,
      mapping = aes(
        x = x, y = y, label = label
      ),
      hjust = 0,
      size = 12
    )
}
myplot
```

<div class="alert alert-info">
  
  * 後製軟體： Choose your own image editor, but make sure it support SVG editing. Here I use [Boxy SVG](https://boxy-svg.com/).
  
  * 程式排版：
```{r}
install.packages("styler")
```
  

</div>

### Save and Export

If you are happy with your graph, you may want to make it reproducible and easy to use.

  * Think of how you want to use it next time.

***
Turn your script into a function, and save in a R script.

  * Select the code lines that you want to turn into a function
  
  * **Code** > **Extract Function**
  
```{r}
myGoodPlot <- function(data4plot) {
  myplot <- {
    ggplot() +
      geom_point(
        data = data4plot$point$data,
        mapping = aes(
          x = x, y = y
        ),
        fill = "#2fc1d3",
        shape = 21,
        color = "black",
        stroke = 1,
        size = 12
      ) +
      geom_text(
        data = data4plot$text$data,
        mapping = aes(
          x = x, y = y, label = label
        ),
        hjust = 0,
        size = 12
      )
  }
  myplot
}
```

```{r}
myGoodPlot <- function(data4plot) {
  myplot <- {
    ggplot() +
      geom_point(
        data = data4plot$point$data,
        mapping = aes(
          x = x, y = y
        ),
        fill = "#2fc1d3",
        shape = 21,
        color = "black",
        stroke = 1,
        size = 12
      ) +
      geom_text(
        data = data4plot$text$data,
        mapping = aes(
          x = x, y = y, label = label
        ),
        hjust = 0,
        size = 12
      )
  }
  myplot
}
```

***

To reuse:
```{r}
source("support/ggplots.R") # suppose this is where your script file is

data4plot <- list()
data4plot$point$data <- {
  data.frame(
    x=c(52.5, 56, 58.5),
    y=c(48.6, 54.9, 58)
  )
}
data4plot$text$data <- {
  data.frame(
    x=c(52.5, 56, 58.5),
    y=c(48.6, 54.9, 58),
    label=c("Colombia", "Norway", "Germany")
  )
}

myGoodPlot(data4plot)
```

  * If you replace `data4plot` with the real data, you get the accurate graph that you want. 
  
### ggdash more

  * ggdash can control any input within a programming block

```{r}
myplot2 <- {
  myshape = 21 #input$shape_point
  ggplot() +
    geom_point(
      data = data4plot$point$data,
      mapping = aes(
        x = x, y = y
      ),
      fill = "#2fc1d3",
      shape = myshape,
      color = "black",
      stroke = 1,
      size = 12
    ) +
    geom_text(
      data = data4plot$text$data,
      mapping = aes(
        x = x + 
          0, #input$x_text
        y = y, label = label
      ),
      hjust = 0,
      size = 12
    )
}
myplot2
```

